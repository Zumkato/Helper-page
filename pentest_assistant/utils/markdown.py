"""Markdown sanitation utilities."""

from __future__ import annotations

import bleach

# No HTML tags are permitted in stored Markdown content.  We strip any tags and
# attributes to prevent XSS when notes are later rendered.

def sanitize_markdown(content: str) -> str:
    """Return a cleaned version of *content* with unsafe HTML removed.

    The function strips all HTML tags and attributes, ensuring that the stored
    Markdown is plain text.  This allows the frontend renderer to safely
    convert the Markdown to HTML without executing arbitrary scripts.
    """
    return bleach.clean(content, tags=[], attributes={}, strip=True)
