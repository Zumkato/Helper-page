"""Mock command executor limited by an allowlist."""

from __future__ import annotations

from typing import Dict

# Mapping of allowed commands to their mocked outputs
ALLOWED_COMMANDS: Dict[str, str] = {
    "nmap": "Mock nmap scan result",
    "whois": "Mock whois result",
    "dig": "Mock dig result",
}


async def run(command: str) -> str:
    """Execute a command from the allowlist and return mocked output.

    Args:
        command: The command string, e.g. ``"nmap"``.
    Raises:
        ValueError: If the command is not in the allowlist.
    Returns:
        Mocked output string.
    """

    cmd = command.split()[0]
    if cmd not in ALLOWED_COMMANDS:
        raise ValueError(f"Command '{cmd}' not allowed.")
    return ALLOWED_COMMANDS[cmd]
